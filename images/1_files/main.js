!function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=5)}([function(e,t,n){"use strict";function o(){var e=r();return{id:e.id||e.userId,name:e.firstName||e.fullName,image:e.thumbnail||e.smallImage}}function r(){return window.pbItem?window.pbItem.creator:window.UserData}function i(e,t){var n=e.getAttribute("is-embed");return t?n===t:"old"===n||"new"===n}function a(){var e="-stg";return l()&&(e=""),"https://impact-stats"+e+".playbuzz.com"}function u(){var e="stg-";return l()&&(e=""),"https://"+e+"user.playbuzz.com"}function c(){var e="-alpha";return l()&&(e=""),"https://impact"+e+".playbuzz.com"}function s(){var e="alpha";return l()&&(e="www"),"https://"+e+".playbuzz.com"}function l(){return!0}function f(e){return null!=e.getAttribute("is-profilepage")}function d(e){var t=f(e),n=t&&e.parentNode&&e.parentNode.classList.contains("Draft"),o=!t&&!i(e)&&window.gameData&&window.gameData.gameSpecificData&&"draft"===gameData.gameSpecificData.status;return n||o}function m(e){return"story"===(e||"").toLowerCase()}function p(){return l()?"production":"staging"}e.exports={getCreator:o,isEmbed:i,getImpactStatsEndpoint:a,getUserServiceUrl:u,getImpactUrl:c,getPbUrl:s,isProfilePage:f,isDraft:d,isStory:m,getEnv:p}},function(e,t,n){"use strict";var o,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};o=function(){return this}();try{o=o||Function("return this")()||(0,eval)("this")}catch(e){"object"===("undefined"==typeof window?"undefined":r(window))&&(o=window)}e.exports=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(14);Object.defineProperty(t,"Logger",{enumerable:!0,get:function(){return o.Logger}})},function(e,t,n){"use strict";function o(){for(var e=window;e.frameElement;)e=e.parent;return e}Object.defineProperty(t,"__esModule",{value:!0}),t.getTopWindow=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AUTHENTICATED_COOKIE_NAME="playbuzz",t.ANONYMOUS_COOKIE_NAME="pb-tracking-id",t.HOME_URL={local:"//alpha.playbuzz.com",staging:"//alpha.playbuzz.com",production:"//www.playbuzz.com"}},function(e,t,n){"use strict";function o(e){a(function(t){if(!u(t)){var n=t.userId,o=s.getCreator().id;if(n===o){return e(!0)}var r=new XMLHttpRequest;r.open("GET",s.getUserServiceUrl()+"/users/"+n+"?channels=true"),r.responseType="json",r.withCredentials=!0,r.send(),r.addEventListener("load",function(t){var n="string"==typeof this.response?JSON.parse(this.response):this.response||{},r=n.channels||[],i=r.filter(function(e){return e.id===o}).length;return e(i)})}})}function r(){var e=i().src.replace("main.js","app.js"),t=document.createElement("script");t.type="text/javascript",t.src=e,document.body.appendChild(t)}function i(){return document.querySelector("#widget-script")}function a(e){c.getAuthenticated().then(function(t){return e(t)})}function u(e){return!e}var c=n(6).UserCookie,s=n(0);!function(){c.init(s.getEnv(),!1),o(function(e){e&&r()})}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(7);Object.defineProperty(t,"UserCookie",{enumerable:!0,get:function(){return o.UserCookie}})},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.UserCookie=void 0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=n(12),i=n(20),a=n(22),u=function(e){return e&&e.__esModule?e:{default:e}}(a),c=n(4),s=t.UserCookie={init:function(e,t){var n=c.HOME_URL[e];!n&&Object.values(c.HOME_URL).indexOf(e)>=0&&(n=e),u.default.init(n,t)},getAuthenticated:function(){var t=s._getLocalAuthenticated();return s._isValidObject(t)?e.resolve(t):s._getAuthenticatedCrossDomainValue()},getAnonymous:function(){var t=s._getLocalAnonymous();return s._isValidString(t)?e.resolve(t):s._getAnonymousCrossDomainValue()},isLoggedIn:function(){return s.getAuthenticated().then(s._isValidObject)},_getAuthenticatedCrossDomainValue:function(){return new e(function(e){return u.default?(u.default.getAuthenticated(e),!0):e(null)})},_getAnonymousCrossDomainValue:function(){return new e(function(e){if(!u.default)throw new Error("pb-tracking-id is missing!");u.default.getAnonymous(e)})},remove:function(){s._removeLocalValue(c.AUTHENTICATED_COOKIE_NAME)},_getLocalAuthenticated:function(){var e=i.CookieService.get(c.AUTHENTICATED_COOKIE_NAME);return e=s._parseJson(e),s._isValidObject(e)?e:localStorage&&(e=r.LocalStorageService.get(c.AUTHENTICATED_COOKIE_NAME)||{},s._isValidObject(e))?e:{}},_getLocalAnonymous:function(){var e=i.CookieService.get(c.ANONYMOUS_COOKIE_NAME);return s._isValidString(e)?e:localStorage&&(e=r.LocalStorageService.get(c.ANONYMOUS_COOKIE_NAME),s._isValidString(e))?e:{}},_removeLocalValue:function(e){i.CookieService.remove(e,{domain:".playbuzz.com",path:"/"}),r.LocalStorageService.remove(e)},_parseJson:function(e){if(null===e||void 0===e)return{};try{return JSON.parse(e)}catch(e){return{}}},_isValidObject:function(e){return null!==e&&"object"===(void 0===e?"undefined":o(e))&&Object.getOwnPropertyNames(e).length>0},_isValidString:function(e){return"string"==typeof e}}}).call(t,n(8))},function(e,t,n){"use strict";(function(t){function n(){}function o(e,t){return function(){e.apply(t,arguments)}}function r(e){if(!(this instanceof r))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(e,this)}function i(e,t){for(;3===e._state;)e=e._value;if(0===e._state)return void e._deferreds.push(t);e._handled=!0,r._immediateFn(function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null===n)return void(1===e._state?a:u)(t.promise,e._value);var o;try{o=n(e._value)}catch(e){return void u(t.promise,e)}a(t.promise,o)})}function a(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"===(void 0===t?"undefined":f(t))||"function"==typeof t)){var n=t.then;if(t instanceof r)return e._state=3,e._value=t,void c(e);if("function"==typeof n)return void l(o(n,t),e)}e._state=1,e._value=t,c(e)}catch(t){u(e,t)}}function u(e,t){e._state=2,e._value=t,c(e)}function c(e){2===e._state&&0===e._deferreds.length&&r._immediateFn(function(){e._handled||r._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)i(e,e._deferreds[t]);e._deferreds=null}function s(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function l(e,t){var n=!1;try{e(function(e){n||(n=!0,a(t,e))},function(e){n||(n=!0,u(t,e))})}catch(e){if(n)return;n=!0,u(t,e)}}var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d=setTimeout;r.prototype.catch=function(e){return this.then(null,e)},r.prototype.then=function(e,t){var o=new this.constructor(n);return i(this,new s(e,t,o)),o},r.prototype.finally=function(e){var t=this.constructor;return this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){return t.reject(n)})})},r.all=function(e){return new r(function(t,n){function o(e,a){try{if(a&&("object"===(void 0===a?"undefined":f(a))||"function"==typeof a)){var u=a.then;if("function"==typeof u)return void u.call(a,function(t){o(e,t)},n)}r[e]=a,0==--i&&t(r)}catch(e){n(e)}}if(!e||void 0===e.length)throw new TypeError("Promise.all accepts an array");var r=Array.prototype.slice.call(e);if(0===r.length)return t([]);for(var i=r.length,a=0;a<r.length;a++)o(a,r[a])})},r.resolve=function(e){return e&&"object"===(void 0===e?"undefined":f(e))&&e.constructor===r?e:new r(function(t){t(e)})},r.reject=function(e){return new r(function(t,n){n(e)})},r.race=function(e){return new r(function(t,n){for(var o=0,r=e.length;o<r;o++)e[o].then(t,n)})},r._immediateFn="function"==typeof t&&function(e){t(e)}||function(e){d(e,0)},r._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},e.exports=r}).call(t,n(9).setImmediate)},function(e,t,n){"use strict";(function(e){function o(e,t){this._id=e,this._clearFn=t}var r=void 0!==e&&e||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;t.setTimeout=function(){return new o(i.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new o(i.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n(10),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||void 0,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||void 0}).call(t,n(1))},function(e,t,n){"use strict";(function(e,t){!function(e,n){function o(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var o={callback:e,args:t};return s[c]=o,u(c),c++}function r(e){delete s[e]}function i(e){var t=e.callback,o=e.args;switch(o.length){case 0:t();break;case 1:t(o[0]);break;case 2:t(o[0],o[1]);break;case 3:t(o[0],o[1],o[2]);break;default:t.apply(n,o)}}function a(e){if(l)setTimeout(a,0,e);else{var t=s[e];if(t){l=!0;try{i(t)}finally{r(e),l=!1}}}}if(!e.setImmediate){var u,c=1,s={},l=!1,f=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,"[object process]"==={}.toString.call(e.process)?function(){u=function(e){t.nextTick(function(){a(e)})}}():function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?function(){var t="setImmediate$"+Math.random()+"$",n=function(n){n.source===e&&"string"==typeof n.data&&0===n.data.indexOf(t)&&a(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),u=function(n){e.postMessage(t+n,"*")}}():e.MessageChannel?function(){var e=new MessageChannel;e.port1.onmessage=function(e){a(e.data)},u=function(t){e.port2.postMessage(t)}}():f&&"onreadystatechange"in f.createElement("script")?function(){var e=f.documentElement;u=function(t){var n=f.createElement("script");n.onreadystatechange=function(){a(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}():function(){u=function(e){setTimeout(a,0,e)}}(),d.setImmediate=o,d.clearImmediate=r}}("undefined"==typeof self?void 0===e?void 0:e:self)}).call(t,n(1),n(11))},function(e,t,n){"use strict";function o(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(e){if(f===setTimeout)return setTimeout(e,0);if((f===o||!f)&&setTimeout)return f=setTimeout,setTimeout(e,0);try{return f(e,0)}catch(t){try{return f.call(null,e,0)}catch(t){return f.call(this,e,0)}}}function a(e){if(d===clearTimeout)return clearTimeout(e);if((d===r||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(e);try{return d(e)}catch(t){try{return d.call(null,e)}catch(t){return d.call(this,e)}}}function u(){v&&p&&(v=!1,p.length?h=p.concat(h):y=-1,h.length&&c())}function c(){if(!v){var e=i(u);v=!0;for(var t=h.length;t;){for(p=h,h=[];++y<t;)p&&p[y].run();y=-1,t=h.length}p=null,v=!1,a(e)}}function s(e,t){this.fun=e,this.array=t}function l(){}var f,d,m=e.exports={};!function(){try{f="function"==typeof setTimeout?setTimeout:o}catch(e){f=o}try{d="function"==typeof clearTimeout?clearTimeout:r}catch(e){d=r}}();var p,h=[],v=!1,y=-1;m.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];h.push(new s(e,t)),1!==h.length||v||i(c)},s.prototype.run=function(){this.fun.apply(null,this.array)},m.title="browser",m.browser=!0,m.env={},m.argv=[],m.version="",m.versions={},m.on=l,m.addListener=l,m.once=l,m.off=l,m.removeListener=l,m.removeAllListeners=l,m.emit=l,m.prependListener=l,m.prependOnceListener=l,m.listeners=function(e){return[]},m.binding=function(e){throw new Error("process.binding is not supported")},m.cwd=function(){return"/"},m.chdir=function(e){throw new Error("process.chdir is not supported")},m.umask=function(){return 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(13);Object.defineProperty(t,"LocalStorageService",{enumerable:!0,get:function(){return o.LocalStorageService}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalStorageService=void 0;var o=n(2),r=new o.Logger({prefix:"LocalStorageService"}),i={set:function(e,t){try{return localStorage.setItem(e,JSON.stringify(t)),!0}catch(e){return r.error(e.message),!1}},get:function(e){if(!e)return null;try{return JSON.parse(localStorage.getItem(e))}catch(e){return r.error(e.message),null}},has:function(e){return null!==this.get(e)},remove:function(e){try{return localStorage.removeItem(e),!0}catch(e){return r.error(e.message),!1}}};t.LocalStorageService=i},function(e,t,n){"use strict";function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n(15);t.Logger=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.prefix,o=void 0===n?"":n,i=t.isDebug,a=void 0!==i&&i;r(this,e),this._prefix=o,this.isDebug=a}return i(e,[{key:"debug",value:function(){if(this.isDebug){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this._log.apply(this,["log"].concat(t))}}},{key:"info",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this._log.apply(this,["info"].concat(t))}},{key:"warn",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this._log.apply(this,["warn"].concat(t))}},{key:"error",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this._log.apply(this,["error"].concat(t))}},{key:"_log",value:function(e){var t;if("undefined"!=typeof window){for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(t=console)[e].apply(t,o(this._format.apply(this,r)))}}},{key:"_format",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var o=[].slice.call(t);return o.unshift("["+a.Timer.deltaFromDomLoadedInSeconds()+"s] ["+this._prefix+"]:"),o}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(16);Object.defineProperty(t,"Timer",{enumerable:!0,get:function(){return o.Timer}})},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Timer=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(17);t.Timer=function(){function e(){o(this,e)}return r(e,[{key:"start",value:function(){this.startTime=window.performance.now()}},{key:"delta",value:function(){return window.performance.now()-this.startTime}}],[{key:"deltaFromDomLoaded",value:function(){var e=(0,i.getTopWindow)(),t=e.performance.timing.domLoading-e.performance.timing.navigationStart;return e.performance.now()-t}},{key:"deltaFromDomLoadedInSeconds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.precision,o=void 0===n?2:n;return(e.deltaFromDomLoaded()/1e3).toFixed(o)}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(18);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var r=n(3);Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})});var i=n(19);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})})},function(e,t,n){"use strict";function o(e,t){var n=void 0,o=void 0;return function(){for(var r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];var u=Date.now();n&&u<n+t?(clearTimeout(o),o=setTimeout(function(){n=u,e.apply(void 0,i)},n+t-u)):(n=u,e.apply(void 0,i))}}function r(e){return Object.keys(e).map(function(t){return[t,e[t]]})}Object.defineProperty(t,"__esModule",{value:!0}),t.throttle=o,t.entries=r},function(e,t,n){"use strict";function o(e){if(!r(e))return e;var t=void 0,n=e.match(s);if(n){if(t=u(n,2)[1],n=t.match(l)){t=u(n,2)[1]}}return t}function r(e){return/^(https?:|ftp)/i.test(e)}function i(){return(0,c.getTopWindow)().location.href}function a(e){var t=window.location.href,n=new RegExp("[?&]"+e+"=([^&#]*)","i"),o=n.exec(t);return o?o[1]:null}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){var n=[],o=!0,r=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(o=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);o=!0);}catch(e){r=!0,i=e}finally{try{!o&&u.return&&u.return()}finally{if(r)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.extractHostname=o,t.isUrl=r,t.getTopUrl=i,t.getQueryStringValue=a;var c=n(3),s=/^(?:https?:\/\/)?(?:[^@\n]+@)?(?:www\.)?([^:\/\n?=]+)/im,l=/^[^.]+\.(.+\..+)$/},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(21);Object.defineProperty(t,"CookieService",{enumerable:!0,get:function(){return o.CookieService}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={get:function(e){return e?decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null:null},set:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=n.vEnd,r=void 0===o?null:o,i=n.sPath,a=void 0===i?"":i,u=n.sDomain,c=void 0===u?"":u,s=n.bSecure,l=void 0===s?"":s;if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var f="";if(r)switch(r.constructor){default:case Number:f=r===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+r;break;case String:f="; expires="+r;break;case Date:f="; expires="+r.toUTCString()}return document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+f+(c?"; domain="+c:"")+(a?"; path="+a:"")+(l?"; secure":""),!0},remove:function(e,t){var n=t.path,o=t.domain;return!!this.has(e)&&(document.cookie=encodeURIComponent(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(o?"; domain="+o:"")+(n?"; path="+n:""),!0)},has:function(e){return!(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))&&new RegExp("(?:^|;\\s*)"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)}};t.CookieService=o},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(23),a=function(e){return e&&e.__esModule?e:{default:e}}(i),u=n(4),c=function(){function e(){o(this,e)}return r(e,[{key:"init",value:function(t,n){var o=this;if(!t)throw new Error("[PlaybuzzUserCookieProvider] Missing playbuzzHomeUrl");this.xdomainCookieProvider=new a.default(t,"",n),this.authenticatedCookie=void 0,this.anonymousCookie=void 0,this.xdomainCookieProvider.get(u.AUTHENTICATED_COOKIE_NAME,function(e){if(e){var t=JSON.parse(e);if("Anonymous"===t.origin||"Anonymous_user"===t.nickname)return o.xdomainCookieProvider.set(u.AUTHENTICATED_COOKIE_NAME,null),void(o.authenticatedCookie=null);o.authenticatedCookie=t}else o.authenticatedCookie=e}),this.xdomainCookieProvider.get(u.ANONYMOUS_COOKIE_NAME,function(t){if(null!==t)return void(o.anonymousCookie=t);o.anonymousCookie=e.generateAnonymousId(),o.xdomainCookieProvider.set(u.ANONYMOUS_COOKIE_NAME,o.anonymousCookie,30)}),this.getAuthenticated=this.getAuthenticated.bind(this),this.getAnonymous=this.getAnonymous.bind(this)}},{key:"getAuthenticated",value:function(e){var t=this;if(void 0!==this.authenticatedCookie)return void e(this.authenticatedCookie);var n=setInterval(function(){void 0!==t.authenticatedCookie&&(clearInterval(n),e(t.authenticatedCookie))},200)}},{key:"getAnonymous",value:function(e){var t=this;if(void 0!==this.anonymousCookie)return void e(this.anonymousCookie);var n=setInterval(function(){void 0!==t.anonymousCookie&&(clearInterval(n),e(t.anonymousCookie))},200)}}],[{key:"generateAnonymousId",value:function(){return Math.random().toString(36).substr(2,8)+Math.random().toString(36).substr(2,8)}}]),e}(),s=new c;t.default=s},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n(2),u=function(){function e(t,n,r){o(this,e),this.iframePath="https:"+t.replace(/^https?:/i,""),this._namespace=n||"xdsc",this._iframeReady=!1,this._callbacks=[],this._failureCallbacks=[],this._xdomainCookieData={},this._id=(new Date).getTime(),this._defaultExpiresDays=30,this._debug=!!r,this._logger=new a.Logger({prefix:"XDOMAIN PAGE"}),this.createIframe=this.createIframe.bind(this),this.onIncomingMessage=this.onIncomingMessage.bind(this),this.firePendingCallbacks=this.firePendingCallbacks.bind(this),this.firePendingFailureCallbacks=this.firePendingFailureCallbacks.bind(this),this.sendDataToIframe=this.sendDataToIframe.bind(this),this.set=this.set.bind(this),this.get=this.get.bind(this),this.createIframe(),window.addEventListener("message",this.onIncomingMessage)}return i(e,[{key:"createIframe",value:function(){var e=document.createElement("iframe");e.style.display="none",e.id="xdomain_cookie_"+this._id;var t=void 0;try{t=window.parent.location.origin}catch(e){}t||(t=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""));var n={namespace:this._namespace,window_origin:t,iframe_origin:this.iframePath,debug:this._debug};e.src=this.iframePath+"/xdomain_cookie.html#"+encodeURIComponent(JSON.stringify(n)),document.body.appendChild(e),this._log("creating iframe",e.src)}},{key:"_log",value:function(){var e;this._debug&&(e=this._logger).log.apply(e,arguments)}},{key:"onIncomingMessage",value:function(e){var t=e.origin||e.originalEvent.origin;if(this.iframePath.substr(0,t.length)===t&&"string"==typeof e.data){var n=null;try{n=JSON.parse(e.data)}catch(e){}!n||"object"!==(void 0===n?"undefined":r(n))||n instanceof Array||"namespace"in n&&n.namespace===this._namespace&&"msg_type"in n&&("xdsc_read"===n.msg_type?(this._log("got data from iframe:",n.cookies),this._xdomainCookieData=n.cookies,this._iframeReady=!0,this.firePendingCallbacks()):"xdsc_fail"===n.msg_type&&(this._log("got failure from iframe"),this.firePendingFailureCallbacks(n.cookie_failed,n.local_storage_failed)))}}},{key:"firePendingCallbacks",value:function(){if(this._iframeReady)for(;this._callbacks.length>0;)this._callbacks.pop()()}},{key:"firePendingFailureCallbacks",value:function(e,t){for(;this._failureCallbacks.length>0;)this._failureCallbacks.pop()(e,t)}},{key:"sendDataToIframe",value:function(e,t,n){var o={namespace:this._namespace,msg_type:"xdsc_write",cookie_name:e,cookie_val:t,expires_days:n};this._log("sending cookie to iframe:",e,t,n),document.getElementById("xdomain_cookie_"+this._id).contentWindow.postMessage(JSON.stringify(o),this.iframePath)}},{key:"set",value:function(e,t){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._defaultExpiresDays;if(!this._iframeReady)return void this._callbacks.push(function(){n.set(e,t,o)});var r=null===t||void 0===t?-100:o;this.sendDataToIframe(e,t,r),this._xdomainCookieData[e]=t}},{key:"get",value:function(e,t){var n=this;this._log("got request for a cookie:",e);var o=function(t,o){n._log("returning response for cookie: ",e,t),"function"==typeof o&&o(t)};this._callbacks.push(function(){var r=e in n._xdomainCookieData?n._xdomainCookieData[e]:null;o(r,t)}),this.firePendingCallbacks()}}]),e}();t.default=u}]);